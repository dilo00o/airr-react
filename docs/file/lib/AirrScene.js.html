<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">lib/AirrScene.js | airr-react</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<meta name="description" content="Reusable React components for building Single Page Apps."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="airr-react"><meta property="twitter:description" content="Reusable React components for building Single Page Apps."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/rafal-r/airr-react"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/AirrMayer.js~AirrMayer.html">AirrMayer</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/AirrScene.js~AirrScene.html">AirrScene</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/AirrSceneWrapper.js~AirrSceneWrapper.html">AirrSceneWrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/AirrSidepanel.js~AirrSidepanel.html">AirrSidepanel</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/AirrView.js~AirrView.html">AirrView</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/AirrViewWrapper.js~AirrViewWrapper.html">AirrViewWrapper</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-AirrFX">AirrFX</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-Helpers">Helpers</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-isMobileDevice">isMobileDevice</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-supportPassive">supportPassive</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">lib/AirrScene.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import React, { Component } from &quot;react&quot;;
import PropTypes from &quot;prop-types&quot;;
import AirrMayer from &quot;./AirrMayer&quot;;

export default class AirrScene extends Component {
    /**
     * Mayers Components refferencies
     */
    mayersCompsRefs = {};

    /**
     * Returns view index from this.props.views array
     *
     * @param {string} viewName
     * @returns {Number}
     */
    getViewIndex(viewName) {
        let index = -1;

        this.props.views.forEach((config, i) =&gt; {
            if (config.props.name === viewName) {
                index = i;
            }
        });

        return index;
    }

    /**
     * Handles navbar backbutton tap events
     *
     * @param {object} e Event object
     * @returns {void}
     */
    handleBackButton = e =&gt; {
        const backBtn = e.currentTarget;
        backBtn.classList.add(&quot;clicked&quot;);

        setTimeout(() =&gt; {
            backBtn.classList.remove(&quot;clicked&quot;);
        }, 300);

        if (
            this.getViewIndex(this.props.activeViewName) === 0 &amp;&amp;
            this.props.handleBackBehaviourOnFirstView
        ) {
            return this.props.handleBackBehaviourOnFirstView();
        }

        if (this.props.handleBackButton) {
            this.props.handleBackButton(e);
        } else {
            console.warn(&quot;[Airr] Back button handler was not specified.&quot;);
        }
    };

    /**
     * Handles navbar menu button tap events
     *
     * @param {object} e Event object
     * @returns {void}
     */
    handleMenuButtonToggleSidepanel = e =&gt; {
        if (
            this.props.refCOMPSidepanel &amp;&amp;
            this.props.refCOMPSidepanel.current
        ) {
            this.props.refCOMPSidepanel.current.isShown()
                ? this.props.refCOMPSidepanel.current.hide()
                : this.props.refCOMPSidepanel.current.show();
        }
    };

    render() {
        const containerClassList = [&quot;airr-container&quot;];
        if (this.props.animation) {
            containerClassList.push(this.props.animation + &quot;-animation&quot;);
        }

        let className = &quot;airr-view airr-scene&quot;;
        this.props.active &amp;&amp; (className += &quot; active&quot;);
        this.props.className &amp;&amp; (className += &quot; &quot; + this.props.className);

        let views = [];
        let isAnyViewActive = false;
        this.props.views.forEach(item =&gt; {
            let viewProps = Object.assign({}, item.props);

            if (viewProps.name === this.props.activeViewName) {
                viewProps.active = true;
                isAnyViewActive = true;
            }

            views.push(React.createElement(item.type, viewProps));
        });

        if (!isAnyViewActive) {
            console.warn(
                &quot;[Airr] No view was set as active&quot; +
                    (this.props.name &amp;&amp; &quot; in Scene named `&quot; + this.props.name) +
                    &quot;.&quot;
            );
        }

        let sidepanel = null;
        if (this.props.sidepanel) {
            sidepanel = React.createElement(
                this.props.sidepanel.type,
                this.props.sidepanel.props
            );
        }

        let blankmask = null;
        if (this.props.GUIDisabled) {
            blankmask = (
                &lt;div className=&quot;airr-blank-mask&quot;&gt;
                    {this.props.GUIDisableCover}
                &lt;/div&gt;
            );
        }

        let mayers = [];
        if (this.props.mayers.length) {
            mayers = this.props.mayers.map(mayerProps =&gt; {
                mayerProps.key = mayerProps.name;
                return React.createElement(AirrMayer, mayerProps);
            });
        }

        let navbar = null;
        if (this.props.navbar) {
            let mockTitle = null;
            let title = &quot;&quot;;
            let back = null;
            const activeViewIndex = this.getViewIndex(
                this.props.activeViewName
            );

            if (this.props.backButton) {
                const backClassName =
                    &quot;back &quot; +
                    (activeViewIndex &lt; 1 &amp;&amp; !this.props.backButtonOnFirstView
                        ? &quot;hidden&quot;
                        : &quot;&quot;);
                back = (
                    &lt;div
                        className={backClassName}
                        onClick={this.handleBackButton}
                    &gt;
                        &lt;div /&gt;
                    &lt;/div&gt;
                );
            }

            let menu;
            if (this.props.navbarMenu) {
                if (this.props.navbarMenu === &quot;toggleSidepanel&quot;) {
                    menu = this.props.sidepanel ? (
                        &lt;div
                            className=&quot;menu&quot;
                            onClick={this.handleMenuButtonToggleSidepanel}
                        &gt;
                            &lt;div /&gt;
                        &lt;/div&gt;
                    ) : null;
                } else if (Array.isArray(this.props.navbarMenu)) {
                    menu = &lt;div className=&quot;menu&quot;&gt;{this.props.navbarMenu}&lt;/div&gt;;
                }
            }

            const navbarStyle = {};
            if ([1, true].indexOf(this.props.navbar) === -1) {
                navbarStyle.visibility = &quot;hidden&quot;;
            }

            if (this.props.mockTitle) {
                const mockTitleContent =
                    this.props.views[activeViewIndex] &amp;&amp;
                    this.props.views[activeViewIndex].props.title;
                const mockTitleViewIndex = this.getViewIndex(
                    this.props.mockTitle
                );
                mockTitle = this.props.mockTitle ? (
                    &lt;div className=&quot;mock-title&quot;&gt;
                        &lt;span&gt;{mockTitleContent}&lt;/span&gt;
                    &lt;/div&gt;
                ) : null;
                title = this.props.views[mockTitleViewIndex]
                    ? this.props.views[mockTitleViewIndex].props.title
                    : &quot;&quot;;
            } else {
                title = this.props.views[activeViewIndex]
                    ? this.props.views[activeViewIndex].props.title
                    : &quot;&quot;;
            }

            navbar = (
                &lt;div
                    className=&quot;airr-navbar&quot;
                    ref={this.props.refDOMNavbar}
                    style={navbarStyle}
                &gt;
                    &lt;div
                        className={this.props.navbarClass}
                        style={{ height: this.props.navbarHeight + &quot;px&quot; }}
                    &gt;
                        {mockTitle}
                        {back}
                        &lt;div
                            className=&quot;title&quot;
                            style={{ opacity: this.props.mockTitle ? 0 : 1 }}
                        &gt;
                            &lt;span&gt;{title}&lt;/span&gt;
                        &lt;/div&gt;
                        {menu}
                    &lt;/div&gt;
                &lt;/div&gt;
            );
        }

        const children =
            typeof this.props.children === &quot;function&quot;
                ? this.props.children(this.props)
                : this.props.children;

        return (
            &lt;div className={className} ref={this.props.refDOM}&gt;
                {navbar}
                &lt;div
                    className={containerClassList.join(&quot; &quot;)}
                    ref={this.props.refDOMContainer}
                &gt;
                    {views}
                &lt;/div&gt;
                {children}
                {sidepanel}
                {mayers}
                {blankmask}
            &lt;/div&gt;
        );
    }
}

AirrScene.defaultProps = {
    name: &quot;&quot;,

    activeViewName: null,
    GUIDisabled: false,
    GUIDisableCover: null,
    animation: &quot;slide&quot;,
    animationTime: 300,
    navbar: false,
    navbarHeight: 48,
    navbarMenu: null,
    navbarClass: &quot;&quot;,
    backButton: false,
    backButtonOnFirstView: false,
    handleBackButton: null,
    handleBackBehaviourOnFirstView: null,
    viewsAnimationEndCallback: null,
    active: false,
    sidepanel: null,
    views: [],
    mayers: [],
    title: &quot;&quot;,
    className: &quot;&quot;
};

AirrScene.propTypes = {
    /**
     * The name of the scene. Must be unique among others views in parent scene. Will be used as identification string
     */
    name: PropTypes.string.isRequired,
    /**
     * Name of the active view.
     */
    activeViewName: PropTypes.string,
    /**
     * Boolean telling if GUI should be disabled meaning no user actions, events are allowed.
     * GUI is disabled via absolute positioned, not visible div that has the biggest z-Index
     */
    GUIDisabled: PropTypes.bool,
    /**
     * React element to be placed in GUI disabling div
     */
    GUIDisableCover: PropTypes.object,
    /**
     * Type of animation to perform when switching views
     */
    animation: PropTypes.oneOf([&quot;slide&quot;, &quot;overlay&quot;, &quot;fade&quot;, false]),
    /**
     * Time of views changing animatio
     */
    animationTime: PropTypes.number,
    /**
     * Specify if navbar is present (1,true) or not (0,false). Or maybe hidden (-1)
     */
    navbar: PropTypes.oneOf([-1, 0, false, 1, true]),
    /**
     * Height of the navbar in pixels
     */
    navbarHeight: PropTypes.number,
    /**
     * Navbar menu is placed on the right most side. Might contain &quot;toggleSidepanel&quot; button or any custom buttons list.
     */
    navbarMenu: function(props, propName, componentName) {
        if (props[propName]) {
            if (typeof props[propName] === &quot;string&quot;) {
                if (!/toggleSidepanel/.test(props[propName])) {
                    return new Error(
                        &quot;Invalid prop `&quot; +
                            propName +
                            &quot;` supplied to&quot; +
                            &quot; `&quot; +
                            componentName +
                            &quot;`. Value must be `toggleSidepanel` string or array of React elements.&quot;
                    );
                } else {
                    return null;
                }
            }

            if (!Array.isArray(props[propName])) {
                return new Error(
                    &quot;Invalid prop `&quot; +
                        propName +
                        &quot;` supplied to&quot; +
                        &quot; `&quot; +
                        componentName +
                        &quot;`. Value must be `toggleSidepanel` string or array of React elements.&quot;
                );
            }
        }
    },
    /**
     * Extra, space separated, navbar&apos;s class names list
     */
    navbarClass: PropTypes.string,
    /**
     * Boolean specifing if navbar renders BackButton. Placed by default on the left side of navbar.
     */
    backButton: PropTypes.bool,
    /**
     * Do you need to still show backButton even if scene is rendering first view from stack?
     */
    backButtonOnFirstView: PropTypes.bool,
    /**
     * Function that will handle back button click events
     */
    handleBackButton: PropTypes.func,
    /**
     * Function that will handle back button clicks events on when first view in stack is active
     */
    handleBackBehaviourOnFirstView: PropTypes.func,
    /**
     * Callback that will be invoked when views animation finishes
     */
    viewsAnimationEndCallback: PropTypes.func,
    /**
     * Is this view active in parent scene
     */
    active: PropTypes.bool,
    /**
     * Sidepanels declaration. Must contain two properties: `type` and `props`
     **/
    sidepanel: PropTypes.shape({
        /**
         * Refference to class or function that will render AirrSidepanel. Might be AirrSidepanel itself.
         */
        type: PropTypes.oneOfType([PropTypes.func, PropTypes.object])
            .isRequired,
        /**
         * Special properties of AirrSidepanel class. Go to class declaration for further properties documenation.
         */
        props: PropTypes.shape({
            /**
             * Side to which sidepanel will be attached
             */
            side: PropTypes.oneOf([&quot;left&quot;, &quot;right&quot;, &quot;top&quot;, &quot;bottom&quot;]),
            /**
             * Bool determining if sidepanel is shown or not
             */
            isShown: PropTypes.bool,
            /**
             * Bool determining if sidepanel is enabled, another words, if its can be drag out
             */
            enabled: PropTypes.bool,
            /**
             * Number between 0 and 1 determining how much size of whole screen sidepanel will take
             */
            sizeFactor: PropTypes.number,
            /**
             * Parent scene width dimension. Passed by scene itself.
             */
            sceneWidth: PropTypes.number.isRequired,
            /**
             * Parent scene height dimension. Passed by scene itself.
             */
            sceneHeight: PropTypes.number.isRequired,
            /**
             * Do you want to animate sidepanel showing in/out
             */
            animateShown: PropTypes.bool,
            /**
             * Callback called when sidepanel changes its visibility during touch events. Passed by scene itself.
             */
            visibilityCallback: PropTypes.func,
            /**
             * Animation time in miliseconds
             */
            animationTime: PropTypes.number,
            /**
             * Opacity between 0 and 1
             */
            bgLayerOpacity: PropTypes.number
        })
    }),
    /**
     * Array of `views`. Every view object declaration must contain two properties: `type` and `props`.
     */
    views: PropTypes.arrayOf(
        PropTypes.shape({
            /**
             * Refference to class or function that will render AirrView. The most common and adviced approach is to use AirrViewWrapper.
             */
            type: PropTypes.oneOfType([PropTypes.func, PropTypes.object])
                .isRequired,
            /**
             * Special properties of AirrView class. Go to class declaration for further properties documenation.
             */
            props: PropTypes.shape({
                /**
                 * The name of the view. Must be unique among others views in scene. Will be used as identification string
                 */
                name: PropTypes.string.isRequired,
                /**
                 * Titlebar name. if parent scene navbar is enabled, this title will be showed there
                 */
                title: PropTypes.string,
                /**
                 * Determine if this view is active. Set by parent scene.
                 */

                active: PropTypes.bool,
                /**
                 * Refference to view&apos;s root DOM element.
                 */
                refDOM: PropTypes.object,
                /**
                 * Extra classes to use. Space separetad string list.
                 */
                className: PropTypes.string,
                /**
                 * Extra styles to use upon root DOM element of view.
                 */
                style: PropTypes.object
            })
        })
    ),
    /**
     * Array of `mayers` objects that will be render into this Scene. Must contain special AirrMayer class properties.
     * To check the possible values of properties go to AirrMayer declaration.
     */
    mayers: PropTypes.arrayOf(
        PropTypes.shape({
            /**
             * The name of the mayer. Must be unique among others mayers in scene. Will be used as identification.
             */
            name: PropTypes.string.isRequired,
            /**
             * Extra styles to apply on Mayer&apos;s DOM element
             */
            style: PropTypes.object,
            /**
             * Parent scene height
             */
            avaibleHeight: PropTypes.number.isRequired,
            /**
             * Side from which mayer content box will enter
             */
            appearFrom: PropTypes.oneOf([&quot;top&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot;]),
            /**
             * Side to which mayer content box will leave
             */
            leaveTo: PropTypes.oneOf([&quot;top&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot;]),
            /**
             * Content of mayer
             */

            content: PropTypes.oneOfType([PropTypes.string, PropTypes.object]),
            /**
             * Array with buttons configuration
             */
            buttons: PropTypes.arrayOf(
                PropTypes.shape({
                    /**
                     * Extra class names to use upon button
                     */
                    className: PropTypes.string,
                    /**
                     * Extra attributes to apply on HTML element
                     */
                    attrs: PropTypes.object,
                    /**
                     * Additional inline styles
                     */
                    style: PropTypes.object,
                    /**
                     * OnClick function handler
                     */
                    handler: PropTypes.func,
                    /**
                     * Content to render inside Mayer. Might be string or ReactElement.
                     */
                    content: PropTypes.oneOfType([
                        PropTypes.string,
                        PropTypes.object
                    ])
                })
            ),
            /**
             * Time in miliseconds of mayer&apos;s appear/disappear animation
             */
            animationTime: PropTypes.number
        })
    ),
    /**
     * Title that will be use in parent Scene navbar title section
     */
    title: PropTypes.string,
    /**
     * Extra, space separated classes names to use upon first div element.
     */
    className: PropTypes.string
};
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
